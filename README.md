# README.md for NixOS Configuration using Home Manager and Flakes

## Introduction

This repository offers a simple yet powerful way to install and configure a NixOS environment tailored to a modern linux desktop workflow with GPU acceleration for containers and virtual environments. It leverages NixOS's reproducibility and the flake system to create a consistent and portable setup.

## Quick Start

1. **Initial Installation**: Install a minimal ISO NixOS from [NixOS Download](https://nixos.org/download).
2. **Network Connection**: Connect with an Ethernet cable or use Network Monitor CLI `nmcli <device> wifi connect <mySSID> password <myPassword>` for a wireless connection.
3. **Download `flake.nix` to `/etc/nixos/`**:
   ```bash
   # Change directory to the NixOs configurations home.
   cd /etc/nixos
   # Open a temporary shell with wget to fetch web files.
   nix-shell -p wget
   sudo wget https://raw.githubusercontent.com/fursman/NixOS/main/flake.nix
   ```
5. **Apply Configuration**: Rebuild NixOS with flakes, home manager and custom configurations.
   ```bash
   # Must be executed from within the /etc/nixos working directory.
   "sudo nixos-rebuild --flake .#desktop switch"
   # ADVANCED CONFIGURATION: To pass your GPU to a virtual server use .#server to rebuild your system with exclusive GPU access for your VM.
   # NOTE: this option requires a second GPU to display your desktop environment and you must update your GPU address in the server.nix config.
   ```

## What's Inside?

### `flake.nix`
- **Description**: "NixOS flake for a desktop environment with Home Manager enabled."
## Inputs

- **nixpkgs**: Points to the NixOS unstable branch.
- **home-manager**: References the home-manager package from the nix-community repository.
- **home-manager.inputs.nixpkgs.follows**: Ensures home-manager follows the nixpkgs version.

## Outputs

The outputs are generated by a function that takes `inputs` and configures the NixOS environment.

## Resources

Fetches various configuration files and scripts from a remote repository:

- **styleCss**: Waybar style CSS.
- **weatherScript**: Python script for weather information.
- **spotlightDarkRasi**: Rofi theme.
- **desktopNix**: Main NixOS system configuration for desktop systems.
- **serverNix**: A decondary NixOS system configuration for NVIDIA GPU passthrough for virtual systems using Virt-Manager.

## Desktop Configuration

- **System Architecture**: x86_64-linux.
- **Modules**: Includes hardware configuration, desktop configuration, and custom configurations.

## Home Manager Integration

- Enables Home Manager for NixOS.
- Configures user environment with various settings, themes, and packages.
  
## Key User Configurations:

- **Rofi theme**: Sets up a custom Rofi theme `spotlightDarkRasi` using the linked resource.
- **Wallpaper Management**: Configures dynamic wallpapers.
- **Pointer Cursor**: Adwaita cursor theme with customization.
- **Kitty Terminal**: Customizes Kitty terminal settings.
- **Waybar**: Configures Waybar with modules for system monitoring and functionality.
- **Hyprland Wayland Compositor**: Enables and configures Hyprland with a detailed setup.
- **GTK Themes**: Sets up Dracula themes for GTK applications.
- **Firefox**: Enables Firefox with specific settings.
- **Package List**: A curated list of packages for the user's environment.
  - **python3.withPackages (requests)**: Provides Python 3 along with the `requests` library, useful for scripting and automating HTTP requests.
  - **gimp**: An advanced image editing software, ideal for photo retouching, image composition, and image authoring.
  - **signal-desktop**: A secure messaging app that offers end-to-end encryption for text, voice, and video communication.
  - **steam**: A popular digital distribution platform for video gaming, offering a vast library of games, automatic game updates, and community features.
  - **xfce.thunar**: A fast and easy-to-use file manager from the XFCE desktop environment.
  - **gnome.eog**: Eye of GNOME, a simple and straightforward image viewer.
  - **links2**: A text and graphical web browser with a pull-down menu system.
  - **wget**: A free utility for non-interactive download of files from the web.
  - **vlc**: A versatile multimedia player that supports various audio and video formats.
  - **rofi-wayland**: A window switcher, application launcher, and dmenu replacement for Wayland.
  - **swayosd**: An on-screen display (OSD) for Sway and Wayland, useful for volume, brightness, and other notifications.
  - **brightnessctl**: A program to read and control device brightness.
  - **hyprpaper**: A wallpaper manager for Sway and Wayland, allows for dynamic wallpaper changes.
  - **swaylock-effects**: A fork of swaylock, adding effects like blur to the lock screen.
  - **wlogout**: A Wayland-based logout menu, useful for cleanly exiting the desktop session.
  - **vscode.fhs**: Visual Studio Code packaged with FHS (Filesystem Hierarchy Standard) support, a popular code editor with a wide range of extensions.
  - **gnome.seahorse**: A front-end for GnuPG, useful for encryption, signing, and key management.
  - **imagemagick**: A software suite to create, edit, compose, or convert bitmap images, supporting many image formats.
- **System State Version**: Defines the NixOS state version as 23.11

### `desktop.nix (dynamically linked)`

## System Configuration

- **Nix Flakes**: Enables experimental features for Nix, including Nix Flakes.
- **Plymouth**: Activates the Plymouth graphical boot splash screen.
- **Bootloader**: Configures systemd-boot with EFI support.
- **Filesystem Support**: Includes support for NTFS filesystems.
- **Networking**: Enables NetworkManager for network configuration and Bluetooth support.
- **Timezone**: Sets the system timezone to America/Vancouver.
- **Locale**: Specifies the default locale to `en_CA.UTF-8`.
- **X11 Windowing System**: Enables the X11 windowing system.
- **GNOME Keyring**: Integrates GNOME keyring for secure storage of credentials.
- **Hyprland**: Enables Hyprland, a Wayland compositor, with NVIDIA patches.
- **Fonts**: Includes Font Awesome in the system's font configuration.

## Hardware and Drivers

- **Bluetooth and Blueman**: Activates Bluetooth hardware support and Blueman services.
- **NVIDIA Drivers**: Configures NVIDIA drivers with modesetting and optional power management features.
- **OpenGL Support**: Enables OpenGL with support for 32-bit DRI (Direct Rendering Infrastructure).

## Software and Packages

- **Git**: Installs Git for version control.
- **NTFS-3G**: Provides NTFS filesystem support, enabling read/write operations on NTFS partitions.
- **Podman Desktop**: Installs Podman for managing OCI (Open Container Initiative) and Docker containers.

## User Configuration

- **Default User Settings**: Defines a default user with access to network management and virtualization groups.
- **Virtualization Support**: Enables Podman for containerization and libvirt with Virt-Manager for virtualization management.
- **SSH Service**: Activates OpenSSH service for secure remote access.

## License

"Do what thou wilt shall be the whole of the Law"
